<svg xmlns="http://www.w3.org/2000/svg" width="1280" height="720" style="background: rgb(255, 255, 255);"><text x="40" y="42" font-size="28" font-weight="700" fill="#0f172a">Code as Prompt サブページA：実行時組み立てアーキテクチャ</text><text x="40" y="72" font-size="15" fill="#475569">テンプレート -&gt; プログラム制約 -&gt; few-shot注入 -&gt; 構造検証</text><rect x="80" y="140" width="510" height="86" rx="12" fill="#dbeafe" stroke="#2563eb" stroke-width="2"/><text x="98" y="176" font-size="24" font-weight="700" fill="#0f172a">L1 Prompt Template</text><text x="98" y="204" font-size="18" fill="#334155">codex_prompt/*.md</text><line x1="335" y1="226" x2="335" y2="250" stroke="#64748b" stroke-width="2.2"/><rect x="80" y="250" width="510" height="86" rx="12" fill="#ffedd5" stroke="#ea580c" stroke-width="2"/><text x="98" y="286" font-size="24" font-weight="700" fill="#0f172a">L2 Prompt Engine</text><text x="98" y="314" font-size="18" fill="#334155">buildPrompt / buildMarkdownPrompt</text><line x1="335" y1="336" x2="335" y2="360" stroke="#64748b" stroke-width="2.2"/><rect x="80" y="360" width="510" height="86" rx="12" fill="#dcfce7" stroke="#16a34a" stroke-width="2"/><text x="98" y="396" font-size="24" font-weight="700" fill="#0f172a">L3 Few-shot Injector</text><text x="98" y="424" font-size="18" fill="#334155">goldenExamplesService + budget fallback</text><line x1="335" y1="446" x2="335" y2="470" stroke="#64748b" stroke-width="2.2"/><rect x="80" y="470" width="510" height="86" rx="12" fill="#ede9fe" stroke="#7c3aed" stroke-width="2"/><text x="98" y="506" font-size="24" font-weight="700" fill="#0f172a">L4 Parser &amp; Quality</text><text x="98" y="534" font-size="18" fill="#334155">PromptParser + observabilityService</text><rect x="660" y="170" width="560" height="430" rx="14" fill="#f8fafc" stroke="#cbd5e1"/><text x="686" y="216" font-size="24" font-weight="700" fill="#0f172a">INTEL表示アーティファクト</text><circle cx="690" cy="252" r="8" fill="#2563eb"/><text x="710" y="260" font-size="20" fill="#334155">Prompt Full Text</text><circle cx="690" cy="318" r="8" fill="#ea580c"/><text x="710" y="326" font-size="20" fill="#334155">Prompt Parsed JSON</text><circle cx="690" cy="384" r="8" fill="#16a34a"/><text x="710" y="392" font-size="20" fill="#334155">Raw LLM Output</text><circle cx="690" cy="450" r="8" fill="#7c3aed"/><text x="710" y="458" font-size="20" fill="#334155">Output Structured</text><circle cx="690" cy="516" r="8" fill="#dc2626"/><text x="710" y="524" font-size="20" fill="#334155">Few-shot Metadata</text><text x="40" y="700" font-size="12" fill="#64748b">Source: services/promptEngine.js + services/goldenExamplesService.js + services/observabilityService.js</text></svg>