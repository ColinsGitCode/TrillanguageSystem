<svg xmlns="http://www.w3.org/2000/svg" width="1280" height="720" style="background: rgb(255, 255, 255);"><text x="40" y="46" font-size="30" font-weight="700" fill="#0f172a">Agent 运行生命周期与可观测信号</text><text x="40" y="74" font-size="15" fill="#475569">以一次生成请求为例：9 阶段采集</text><circle cx="80" cy="220" r="28" fill="#dbeafe" stroke="#2563eb" stroke-width="2"></circle><text x="80" y="227" text-anchor="middle" font-size="14" font-weight="700" fill="#1e40af">1</text><text x="80" y="270" text-anchor="middle" font-size="13" fill="#0f172a">Request</text><line x1="110" y1="220" x2="180" y2="220" stroke="#94a3b8" stroke-width="2"></line><circle cx="210" cy="220" r="28" fill="#dbeafe" stroke="#2563eb" stroke-width="2"></circle><text x="210" y="227" text-anchor="middle" font-size="14" font-weight="700" fill="#1e40af">2</text><text x="210" y="270" text-anchor="middle" font-size="13" fill="#0f172a">PromptBuild</text><line x1="240" y1="220" x2="310" y2="220" stroke="#94a3b8" stroke-width="2"></line><circle cx="340" cy="220" r="28" fill="#dbeafe" stroke="#2563eb" stroke-width="2"></circle><text x="340" y="227" text-anchor="middle" font-size="14" font-weight="700" fill="#1e40af">3</text><text x="340" y="270" text-anchor="middle" font-size="13" fill="#0f172a">LLMCall</text><line x1="370" y1="220" x2="440" y2="220" stroke="#94a3b8" stroke-width="2"></line><circle cx="470" cy="220" r="28" fill="#dbeafe" stroke="#2563eb" stroke-width="2"></circle><text x="470" y="227" text-anchor="middle" font-size="14" font-weight="700" fill="#1e40af">4</text><text x="470" y="270" text-anchor="middle" font-size="13" fill="#0f172a">Parse</text><line x1="500" y1="220" x2="570" y2="220" stroke="#94a3b8" stroke-width="2"></line><circle cx="600" cy="220" r="28" fill="#dbeafe" stroke="#2563eb" stroke-width="2"></circle><text x="600" y="227" text-anchor="middle" font-size="14" font-weight="700" fill="#1e40af">5</text><text x="600" y="270" text-anchor="middle" font-size="13" fill="#0f172a">PostProcess</text><line x1="630" y1="220" x2="700" y2="220" stroke="#94a3b8" stroke-width="2"></line><circle cx="730" cy="220" r="28" fill="#dbeafe" stroke="#2563eb" stroke-width="2"></circle><text x="730" y="227" text-anchor="middle" font-size="14" font-weight="700" fill="#1e40af">6</text><text x="730" y="270" text-anchor="middle" font-size="13" fill="#0f172a">Render</text><line x1="760" y1="220" x2="830" y2="220" stroke="#94a3b8" stroke-width="2"></line><circle cx="860" cy="220" r="28" fill="#dbeafe" stroke="#2563eb" stroke-width="2"></circle><text x="860" y="227" text-anchor="middle" font-size="14" font-weight="700" fill="#1e40af">7</text><text x="860" y="270" text-anchor="middle" font-size="13" fill="#0f172a">Save</text><line x1="890" y1="220" x2="960" y2="220" stroke="#94a3b8" stroke-width="2"></line><circle cx="990" cy="220" r="28" fill="#dbeafe" stroke="#2563eb" stroke-width="2"></circle><text x="990" y="227" text-anchor="middle" font-size="14" font-weight="700" fill="#1e40af">8</text><text x="990" y="270" text-anchor="middle" font-size="13" fill="#0f172a">TTS</text><line x1="1020" y1="220" x2="1090" y2="220" stroke="#94a3b8" stroke-width="2"></line><circle cx="1120" cy="220" r="28" fill="#dbeafe" stroke="#2563eb" stroke-width="2"></circle><text x="1120" y="227" text-anchor="middle" font-size="14" font-weight="700" fill="#1e40af">9</text><text x="1120" y="270" text-anchor="middle" font-size="13" fill="#0f172a">DBPersist</text><text x="80" y="384" font-size="20" font-weight="700" fill="#0f172a">Logs</text><rect x="220" y="360" width="980" height="34" rx="8" fill="#e2e8f0"></rect><rect x="220" y="360" width="980" height="34" rx="8" fill="#2563eb"></rect><text x="235" y="383" font-size="15" fill="white">request_id, provider, errors</text><text x="80" y="439" font-size="20" font-weight="700" fill="#0f172a">Metrics</text><rect x="220" y="415" width="980" height="34" rx="8" fill="#e2e8f0"></rect><rect x="220" y="415" width="980" height="34" rx="8" fill="#16a34a"></rect><text x="235" y="438" font-size="15" fill="white">quality, tokens, latency, cost</text><text x="80" y="494" font-size="20" font-weight="700" fill="#0f172a">Traces</text><rect x="220" y="470" width="980" height="34" rx="8" fill="#e2e8f0"></rect><rect x="220" y="470" width="980" height="34" rx="8" fill="#9333ea"></rect><text x="235" y="493" font-size="15" fill="white">phase timing + tool spans</text><text x="80" y="549" font-size="20" font-weight="700" fill="#0f172a">Events</text><rect x="220" y="525" width="980" height="34" rx="8" fill="#e2e8f0"></rect><rect x="220" y="525" width="980" height="34" rx="8" fill="#ea580c"></rect><text x="235" y="548" font-size="15" fill="white">few-shot fallback / model switch</text><text x="40" y="700" font-size="12" fill="#64748b">Source: server.js pipeline + observability_metrics schema</text></svg>